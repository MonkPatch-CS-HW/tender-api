generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = "postgresql://postgres:postgres@localhost:5432"
}

model employee {
  id                      String                    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  username                String                    @unique @db.VarChar(50)
  firstName               String?                   @map("first_name") @db.VarChar(50)
  lastName                String?                   @map("last_name") @db.VarChar(50)
  createdAt               DateTime?                 @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt               DateTime?                 @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  organizationResponsible organizationResponsible[]
  bid                     bid[]
}

model organization {
  id                      String                    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  name                    String                    @db.VarChar(100)
  description             String?
  type                    organizationType?
  createdAt               DateTime?                 @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt               DateTime?                 @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  organizationResponsible organizationResponsible[]
  tender                  tender[]
  bid                     bid[]
}

model organizationResponsible {
  id             String        @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  organizationId String?       @map("organization_id") @db.Uuid
  userId         String?       @map("user_id") @db.Uuid
  organization   organization? @relation(fields: [organizationId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  employee       employee?     @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@map("organization_responsible")
}

model bid {
  id           String         @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  name         String         @db.VarChar(100)
  description  String?
  status       bidStatus?
  tenderId     String?        @map("tender_id") @db.Uuid
  tender       tender?        @relation(fields: [tenderId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  authorType   bidAuthorType? @map("author_type")
  authorId     String?        @map("author_id") @db.Uuid
  organization organization?  @relation(fields: [authorId], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "bid_organization_fkey")
  employee     employee?      @relation(fields: [authorId], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "bid_employee_fkey")
  version      Int            @default(1)
  createdAt    DateTime?      @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt    DateTime?      @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
}

model tender {
  id             String             @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  name           String             @db.VarChar(100)
  description    String?
  serviceType    tenderServiceType? @map("service_type")
  bids           bid[]
  status         tenderStatus?
  organizationId String?            @map("organization_id") @db.Uuid
  organization   organization?      @relation(fields: [organizationId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  version        Int                @default(1)
  createdAt      DateTime?          @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt      DateTime?          @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
}

enum bidAuthorType {
  Organization
  User

  @@map("bud_author_type")
}

enum tenderServiceType {
  Construction
  Delivery
  Manufacture

  @@map("tender_service_type")
}

enum tenderStatus {
  Created
  Published
  Canceled

  @@map("tender_status")
}

enum bidStatus {
  Created
  Published
  Canceled

  @@map("bid_status")
}

enum organizationType {
  IE
  LLC
  JSC

  @@map("organization_type")
}
